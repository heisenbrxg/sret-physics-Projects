!DOCTYPE html>
<html lang="en">

<head>
    Â  Â 
    <meta charset="UTF-8">
    Â  Â 
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    Â  Â  <title>Emission Spectrum Analyzer</title>
    Â  Â  <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            padding: 30px;
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 2.2em;
        }

        .diagram-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
            position: relative;
            min-height: 400px;
        }

        .element-selection {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px;
            background: white;
            border-radius: 10px;
        }

        .element-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .element-btn {
            padding: 10px 20px;
            border: 2px solid #3498db;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            position: relative;
        }

        .element-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }

        .element-btn.active {
            background: #3498db;
            color: white;
        }

        .flow-diagram {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 30px;
            position: relative;
            gap: 20px;
        }

        .component {
            background: white;
            border: 3px solid #2c3e50;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            min-width: 120px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 10;
        }

        .component.light-source {
            background: radial-gradient(circle, #FFFFFF, #F0F0F0);
            border-color: #2c3e50;
            position: relative;
            overflow: visible;
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.8), 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .light-source::after {
            content: 'ðŸ’¡';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            animation: bulbGlow 2s infinite;
        }

        @keyframes bulbGlow {

            0%,
            100% {
                filter: brightness(1);
                text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
            }

            50% {
                filter: brightness(1.3);
                text-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
            }
        }

        .light-beam {
            position: absolute;
            left: 100%;
            top: 50%;
            width: 0;
            height: 30px;
            background: linear-gradient(90deg,
                    rgba(255, 255, 255, 0.9) 0%,
                    rgba(255, 255, 255, 0.7) 30%,
                    rgba(255, 220, 180, 0.5) 60%,
                    rgba(255, 200, 150, 0.3) 80%,
                    transparent 100%);
            transform: translateY(-50%);
            transition: width 0.5s;
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.8), 0 0 60px rgba(255, 220, 180, 0.5);
            filter: blur(1px);
        }

        .light-beam.active {
            width: 400px;
            animation: lightPulse 2s infinite;
        }

        @keyframes lightPulse {

            0%,
            100% {
                opacity: 0.7;
                filter: blur(1px);
            }

            50% {
                opacity: 1;
                filter: blur(2px);
            }
        }

        .light-ray {
            position: absolute;
            left: 100%;
            top: 50%;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg,
                    rgba(255, 255, 255, 1),
                    rgba(255, 255, 255, 0.8),
                    transparent);
            transform: translateY(-50%);
            opacity: 0;
            transition: all 0.5s;
        }

        .light-ray.active {
            width: 400px;
            animation: rayShimmer 1.5s infinite;
        }

        .light-ray.ray1 {
            margin-top: -12px;
        }

        .light-ray.ray2 {
            margin-top: -6px;
        }

        .light-ray.ray3 {
            margin-top: 0px;
        }

        .light-ray.ray4 {
            margin-top: 6px;
        }

        .light-ray.ray5 {
            margin-top: 12px;
        }

        @keyframes rayShimmer {

            0%,
            100% {
                opacity: 0.3;
            }

            50% {
                opacity: 0.8;
            }
        }

        .lens {
            width: 15px;
            height: 100px;
            position: relative;
            flex-shrink: 0;
        }

        .lens::before {
            content: '';
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            height: 100%;
            border: 3px solid #2c3e50;
            border-radius: 50%;
            background: radial-gradient(ellipse at 30% 30%,
                    rgba(255, 255, 255, 0.5) 0%,
                    rgba(173, 216, 230, 0.4) 30%,
                    rgba(135, 206, 250, 0.3) 60%,
                    rgba(173, 216, 230, 0.2) 100%);
            box-shadow:
                inset 0 0 20px rgba(255, 255, 255, 0.6),
                inset -3px -3px 10px rgba(0, 0, 0, 0.1),
                0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .lens::after {
            content: '';
            position: absolute;
            left: 20%;
            top: 20%;
            width: 30%;
            height: 25%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.8), transparent);
            border-radius: 50%;
            filter: blur(2px);
        }

        .atomizer-container {
            position: relative;
            min-width: 150px;
            height: 120px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .sample-box {
            width: 100px;
            height: 80px;
            border: 3px solid #2c3e50;
            background: rgba(200, 200, 200, 0.3);
            border-radius: 8px;
            position: relative;
            overflow: hidden;
        }

        .element-particle {
            position: absolute;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 16px;
            top: -50px;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            z-index: 100;
        }

        .element-particle.drop {
            animation: dropIn 1s ease-in forwards;
        }

        .element-particle.bounce {
            animation: bounceIn 1s ease-out forwards;
        }

        .element-particle.spiral {
            animation: spiralIn 1.5s ease-in-out forwards;
        }

        .element-particle.explode {
            animation: explodeIn 1s ease-out forwards;
        }

        @keyframes dropIn {
            0% {
                top: -50px;
                opacity: 0;
            }

            50% {
                opacity: 1;
            }

            100% {
                top: 20px;
                opacity: 1;
            }
        }

        @keyframes bounceIn {
            0% {
                top: -50px;
                opacity: 0;
            }

            40% {
                top: 40px;
                opacity: 1;
            }

            60% {
                top: 10px;
            }

            80% {
                top: 30px;
            }

            100% {
                top: 20px;
                opacity: 1;
            }
        }

        @keyframes spiralIn {
            0% {
                top: -50px;
                left: 0%;
                opacity: 0;
                transform: rotate(0deg) scale(0.5);
            }

            50% {
                left: 100%;
                opacity: 1;
            }

            100% {
                top: 20px;
                left: 50%;
                opacity: 1;
                transform: translateX(-50%) rotate(720deg) scale(1);
            }
        }

        @keyframes explodeIn {
            0% {
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%) scale(3);
                opacity: 0;
            }

            50% {
                opacity: 1;
            }

            100% {
                top: 20px;
                left: 50%;
                transform: translateX(-50%) scale(1);
                opacity: 1;
            }
        }

        .glow-effect {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            animation: glow 2s infinite;
        }

        @keyframes glow {

            0%,
            100% {
                box-shadow: 0 0 20px currentColor, 0 0 40px currentColor;
            }

            50% {
                box-shadow: 0 0 40px currentColor, 0 0 60px currentColor;
            }
        }

        .emission-cloud {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            opacity: 0;
            pointer-events: none;
        }

        .emission-cloud.active {
            animation: cloudGlow 2s infinite;
        }

        @keyframes cloudGlow {

            0%,
            100% {
                opacity: 0.3;
                filter: blur(10px);
            }

            50% {
                opacity: 0.6;
                filter: blur(15px);
            }
        }

        .arrow {
            font-size: 2em;
            color: #2c3e50;
            font-weight: bold;
            flex-shrink: 0;
        }

        .wavelength-selector {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .spectrum-display {
            width: 150px;
            height: 60px;
            background: #000;
            border-radius: 5px;
            margin-top: 10px;
            position: relative;
            overflow: hidden;
        }

        .spectrum-line {
            position: absolute;
            width: 3px;
            height: 100%;
            top: 0;
            opacity: 0;
            transition: opacity 0.5s;
        }

        .spectrum-line.visible {
            opacity: 1;
            box-shadow: 0 0 10px currentColor;
        }

        .controls {
            margin-top: 20px;
            text-align: center;
        }

        .wavelength-control {
            display: inline-block;
            margin: 10px;
        }

        .wavelength-control label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            color: #2c3e50;
        }

        .wavelength-control input[type="range"] {
            width: 300px;
        }

        .wavelength-value {
            display: inline-block;
            margin-left: 10px;
            padding: 5px 10px;
            background: #3498db;
            color: white;
            border-radius: 5px;
            font-weight: bold;
        }

        .graph-section {
            margin-top: 30px;
            background: white;
            border-radius: 10px;
            padding: 20px;
            border: 2px solid #2c3e50;
        }

        .graph-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
        }

        canvas {
            border: 2px solid #2c3e50;
            border-radius: 10px;
            width: 100%;
            background: #000;
        }
    </style>
</head>

<body>
    Â  Â  <div class="container">
        Â  Â  Â  Â  <h1>ðŸ”¬ Atomic Emission Spectrum Analyzer</h1>
        Â  Â  Â  Â 
        Â  Â  Â  Â  <div class="diagram-section">
            Â  Â  Â  Â  Â  Â  <div class="element-selection">
                Â  Â  Â  Â  Â  Â  Â  Â  <h3 style="color: #2c3e50; margin-bottom: 10px;">Select Element to Analyze</h3>
                Â  Â  Â  Â  Â  Â  Â  Â  <div class="element-buttons">
                    Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="element-btn" data-element="hydrogen"
                        data-color="#FF6B6B">Hydrogen (H)</button>
                    Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="element-btn" data-element="helium" data-color="#4ECDC4">Helium
                        (He)</button>
                    Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="element-btn" data-element="sodium" data-color="#FFD93D">Sodium
                        (Na)</button>
                    Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="element-btn" data-element="mercury" data-color="#A8DADC">Mercury
                        (Hg)</button>
                    Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="element-btn" data-element="neon" data-color="#FF8DC7">Neon
                        (Ne)</button>
                    Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="element-btn" data-element="calcium" data-color="#95E1D3">Calcium
                        (Ca)</button>
                    Â  Â  Â  Â  Â  Â  Â  Â  </div>
                Â  Â  Â  Â  Â  Â  </div>
            Â  Â  Â  Â  Â  Â 
            Â  Â  Â  Â  Â  Â  <div class="flow-diagram">
                Â  Â  Â  Â  Â  Â  Â  Â  <div class="component light-source">
                    Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <strong>Radiation<br>Source</strong>
                    Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="light-beam" id="lightBeam"></div>
                    Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="light-ray ray1" id="lightRay1"></div>
                    Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="light-ray ray2" id="lightRay2"></div>
                    Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="light-ray ray3" id="lightRay3"></div>
                    Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="light-ray ray4" id="lightRay4"></div>
                    Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="light-ray ray5" id="lightRay5"></div>
                    Â  Â  Â  Â  Â  Â  Â  Â  </div>
                Â  Â  Â  Â  Â  Â  Â  Â 
                Â  Â  Â  Â  Â  Â  Â  Â  <div class="lens"></div>
                Â  Â  Â  Â  Â  Â  Â  Â 
                Â  Â  Â  Â  Â  Â  Â  Â  <div class="atomizer-container">
                    Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="sample-box" id="sampleBox">
                        Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="emission-cloud" id="emissionCloud"></div>
                        Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
                    Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="margin-top: 5px; font-weight: bold; font-size: 12px;">Atomizer</div>
                    Â  Â  Â  Â  Â  Â  Â  Â  </div>
                Â  Â  Â  Â  Â  Â  Â  Â 
                Â  Â  Â  Â  Â  Â  Â  Â  <div class="lens"></div>
                Â  Â  Â  Â  Â  Â  Â  Â 
                Â  Â  Â  Â  Â  Â  Â  Â  <div class="component wavelength-selector">
                    Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <strong>Wavelength<br>Selector</strong>
                    Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="spectrum-display" id="miniSpectrum"></div>
                    Â  Â  Â  Â  Â  Â  Â  Â  </div>
                Â  Â  Â  Â  Â  Â  Â  Â 
                Â  Â  Â  Â  Â  Â  Â  Â  <div class="arrow">â†’</div>
                Â  Â  Â  Â  Â  Â  Â  Â 
                Â  Â  Â  Â  Â  Â  Â  Â  <div class="component">
                    Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <strong>Detector</strong>
                    Â  Â  Â  Â  Â  Â  Â  Â  </div>
                Â  Â  Â  Â  Â  Â  </div>
            Â  Â  Â  Â  Â  Â 
            Â  Â  Â  Â  Â  Â  <div class="controls">
                Â  Â  Â  Â  Â  Â  Â  Â  <div class="wavelength-control">
                    Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label>Wavelength Control:</label>
                    Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="range" id="wavelengthSlider" min="380" max="750" value="500"
                        step="1">
                    Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="wavelength-value" id="wavelengthValue">500 nm</span>
                    Â  Â  Â  Â  Â  Â  Â  Â  </div>
                Â  Â  Â  Â  Â  Â  </div>
            Â  Â  Â  Â  </div>
        Â  Â  Â  Â 
        Â  Â  Â  Â  <div class="graph-section">
            Â  Â  Â  Â  Â  Â  <h3>Emission Spectrum Analysis</h3>
            Â  Â  Â  Â  Â  Â  <canvas id="spectrumCanvas" width="1200" height="350"></canvas>
            Â  Â  Â  Â  </div>
        Â  Â  </div>
    Â  Â 
    Â  Â 
    <script>
        const canvas = document.getElementById('spectrumCanvas');
        const ctx = canvas.getContext('2d');

        const emissionData = {
            hydrogen: {
                name: 'H',
                color: '#FF6B6B',
                lines: [
                    { wavelength: 410.2, intensity: 0.4 },
                    { wavelength: 434.0, intensity: 0.6 },
                    { wavelength: 486.1, intensity: 0.8 },
                    { wavelength: 656.3, intensity: 1.0 }
                ]
            },
            helium: {
                name: 'He',
                color: '#4ECDC4',
                lines: [
                    { wavelength: 447.1, intensity: 0.7 },
                    { wavelength: 471.3, intensity: 0.6 },
                    { wavelength: 501.6, intensity: 0.8 },
                    { wavelength: 587.6, intensity: 1.0 },
                    { wavelength: 667.8, intensity: 0.7 }
                ]
            },
            sodium: {
                name: 'Na',
                color: '#FFD93D',
                lines: [
                    { wavelength: 589.0, intensity: 1.0 },
                    { wavelength: 589.6, intensity: 1.0 }
                ]
            },
            mercury: {
                name: 'Hg',
                color: '#A8DADC',
                lines: [
                    { wavelength: 404.7, intensity: 0.8 },
                    { wavelength: 435.8, intensity: 0.9 },
                    { wavelength: 546.1, intensity: 1.0 },
                    { wavelength: 577.0, intensity: 0.6 },
                    { wavelength: 579.0, intensity: 0.6 }
                ]
            },
            neon: {
                name: 'Ne',
                color: '#FF8DC7',
                lines: [
                    { wavelength: 540.1, intensity: 0.7 },
                    { wavelength: 585.2, intensity: 0.8 },
                    { wavelength: 614.3, intensity: 0.6 },
                    { wavelength: 640.2, intensity: 1.0 },
                    { wavelength: 703.2, intensity: 0.8 }
                ]
            },
            calcium: {
                name: 'Ca',
                color: '#95E1D3',
                lines: [
                    { wavelength: 422.7, intensity: 1.0 },
                    { wavelength: 445.5, intensity: 0.6 },
                    { wavelength: 527.0, intensity: 0.5 },
                    { wavelength: 558.9, intensity: 0.7 },
                    { wavelength: 643.9, intensity: 0.6 }
                ]
            }
        };

        let currentElement = null;
        let currentWavelength = 500;
        const animations = ['drop', 'bounce', 'spiral', 'explode'];
        let animationIndex = 0;

        function wavelengthToColor(wavelength) {
            let r, g, b;

            if (wavelength >= 380 && wavelength < 440) {
                r = -(wavelength - 440) / (440 - 380);
                g = 0;
                b = 1;
            } else if (wavelength >= 440 && wavelength < 490) {
                r = 0;
                g = (wavelength - 440) / (490 - 440);
                b = 1;
            } else if (wavelength >= 490 && wavelength < 510) {
                r = 0;
                g = 1;
                b = -(wavelength - 510) / (510 - 490);
            } else if (wavelength >= 510 && wavelength < 580) {
                r = (wavelength - 510) / (580 - 510);
                g = 1;
                b = 0;
            } else if (wavelength >= 580 && wavelength < 645) {
                r = 1;
                g = -(wavelength - 645) / (645 - 580);
                b = 0;
            } else if (wavelength >= 645 && wavelength <= 750) {
                r = 1;
                g = 0;
                b = 0;
            } else {
                r = 0;
                g = 0;
                b = 0;
            }

            r = Math.round(r * 255);
            g = Math.round(g * 255);
            b = Math.round(b * 255);

            return `rgb(${r}, ${g}, ${b})`;
        }

        function addElementToBox(element, color) {
            const sampleBox = document.getElementById('sampleBox');
            const existingParticle = sampleBox.querySelector('.element-particle');
            if (existingParticle) {
                existingParticle.remove();
            }

            const particle = document.createElement('div');
            particle.className = `element-particle ${animations[animationIndex]}`;
            particle.textContent = emissionData[element].name;
            particle.style.background = color;

            const glowEffect = document.createElement('div');
            glowEffect.className = 'glow-effect';
            glowEffect.style.color = color;
            particle.appendChild(glowEffect);

            sampleBox.appendChild(particle);

            animationIndex = (animationIndex + 1) % animations.length;

            setTimeout(() => {
                document.getElementById('lightBeam').classList.add('active');
                document.getElementById('lightRay1').classList.add('active');
                document.getElementById('lightRay2').classList.add('active');
                document.getElementById('lightRay3').classList.add('active');
                document.getElementById('lightRay4').classList.add('active');
                document.getElementById('lightRay5').classList.add('active');
                document.getElementById('emissionCloud').classList.add('active');
                document.getElementById('emissionCloud').style.background = `radial-gradient(circle, ${color}, transparent)`;
            }, 1000);
        }

        function updateMiniSpectrum() {
            const miniSpectrum = document.getElementById('miniSpectrum');
            miniSpectrum.innerHTML = '';

            if (!currentElement) return;

            const lines = emissionData[currentElement].lines;
            lines.forEach((line, index) => {
                const lineEl = document.createElement('div');
                lineEl.className = 'spectrum-line';
                lineEl.style.backgroundColor = wavelengthToColor(line.wavelength);
                lineEl.style.left = `${(index / lines.length) * 100}%`;

                const wavelengthDiff = Math.abs(currentWavelength - line.wavelength);
                if (wavelengthDiff < 50) {
                    lineEl.classList.add('visible');
                }

                miniSpectrum.appendChild(lineEl);
            });
        }

        function drawSpectrum() {
            ctx.fillStyle = '#000000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            if (!currentElement) {
                ctx.fillStyle = '#FFFFFF';
                ctx.font = '20px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('Select an element to view its emission spectrum', canvas.width / 2, canvas.height / 2);
                return;
            }

            const lines = emissionData[currentElement].lines;

            // Draw continuous spectrum background at top
            const spectrumHeight = 50;
            const spectrumY = 30;

            for (let wl = 380; wl <= 750; wl += 1) {
                const x = mapWavelengthToX(wl);
                const color = wavelengthToColor(wl);
                ctx.fillStyle = color;
                ctx.fillRect(x, spectrumY, 2, spectrumHeight);
            }

            // Label the continuous spectrum
            ctx.fillStyle = '#FFFFFF';
            ctx.font = 'bold 14px Arial';
            ctx.textAlign = 'left';
            ctx.fillText('Continuous Spectrum (White Light)', 55, spectrumY - 10);

            // Draw black background for emission lines area
            const emissionY = spectrumY + spectrumHeight + 30;
            ctx.fillStyle = '#000000';
            ctx.fillRect(50, emissionY, canvas.width - 100, 180);

            // Label emission lines area
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText(`${currentElement.charAt(0).toUpperCase() + currentElement.slice(1)} Emission Lines`, 55, emissionY - 5);

            // Draw wavelength scale
            const scaleY = emissionY + 170;
            ctx.strokeStyle = '#FFFFFF';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(50, scaleY);
            ctx.lineTo(canvas.width - 50, scaleY);
            ctx.stroke();

            ctx.fillStyle = '#FFFFFF';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';

            for (let wl = 400; wl <= 700; wl += 50) {
                const x = mapWavelengthToX(wl);
                ctx.beginPath();
                ctx.moveTo(x, scaleY);
                ctx.lineTo(x, scaleY + 10);
                ctx.stroke();
                ctx.fillText(wl + ' nm', x, scaleY + 25);
            }

            // Draw emission lines - only show lines at or below current wavelength
            lines.forEach(line => {
                // Only show lines if wavelength is less than or equal to current wavelength
                if (line.wavelength > currentWavelength) {
                    return; // Skip this line
                }

                const x = mapWavelengthToX(line.wavelength);
                const height = 150 * line.intensity;
                const color = wavelengthToColor(line.wavelength);

                const wavelengthDiff = Math.abs(currentWavelength - line.wavelength);
                const proximity = Math.max(0, 1 - wavelengthDiff / 100);

                ctx.shadowBlur = 25 * (0.6 + proximity * 0.4);
                ctx.shadowColor = color;
                ctx.strokeStyle = color;
                ctx.lineWidth = 5 + proximity * 3;
                ctx.globalAlpha = 0.85 + proximity * 0.15;

                ctx.beginPath();
                ctx.moveTo(x, scaleY);
                ctx.lineTo(x, scaleY - height);
                ctx.stroke();

                ctx.shadowBlur = 35 * (0.6 + proximity * 0.4);
                ctx.fillStyle = color;
                ctx.beginPath();
                ctx.arc(x, scaleY - height, 6 + proximity * 3, 0, Math.PI * 2);
                ctx.fill();

                // Always show wavelength labels for visible lines
                ctx.globalAlpha = 0.7 + proximity * 0.3;
                ctx.shadowBlur = 0;
                ctx.fillStyle = '#FFFFFF';
                ctx.font = 'bold 10px Arial';
                ctx.fillText(line.wavelength.toFixed(1) + ' nm', x, scaleY - height - 12);
            });

            ctx.globalAlpha = 1;
            ctx.shadowBlur = 0;

            // Draw current wavelength indicator
            const indicatorX = mapWavelengthToX(currentWavelength);
            ctx.strokeStyle = '#FFD700';
            ctx.lineWidth = 3;
            ctx.setLineDash([8, 5]);
            ctx.beginPath();
            ctx.moveTo(indicatorX, 20);
            ctx.lineTo(indicatorX, scaleY + 10);
            ctx.stroke();
            ctx.setLineDash([]);

            ctx.fillStyle = '#FFD700';
            ctx.font = 'bold 16px Arial';
            ctx.fillText('â–¼', indicatorX, 18);
        }

        function mapWavelengthToX(wavelength) {
            const minWl = 380;
            const maxWl = 750;
            const margin = 50;
            return margin + ((wavelength - minWl) / (maxWl - minWl)) * (canvas.width - 2 * margin);
        }

        // Element button listeners
        document.querySelectorAll('.element-btn').forEach(btn => {
            btn.addEventListener('click', function () {
                document.querySelectorAll('.element-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');

                const element = this.dataset.element;
                const color = this.dataset.color;
                currentElement = element;

                document.getElementById('lightBeam').classList.remove('active');
                document.getElementById('lightRay1').classList.remove('active');
                document.getElementById('lightRay2').classList.remove('active');
                document.getElementById('lightRay3').classList.remove('active');
                document.getElementById('lightRay4').classList.remove('active');
                document.getElementById('lightRay5').classList.remove('active');
                document.getElementById('emissionCloud').classList.remove('active');

                addElementToBox(element, color);

                setTimeout(() => {
                    drawSpectrum();
                    updateMiniSpectrum();
                }, 1000);
            });
        });

        // Wavelength slider listener
        document.getElementById('wavelengthSlider').addEventListener('input', function () {
            currentWavelength = parseInt(this.value);
            document.getElementById('wavelengthValue').textContent = currentWavelength + ' nm';
            document.getElementById('wavelengthValue').style.backgroundColor = wavelengthToColor(currentWavelength);
            drawSpectrum();
            updateMiniSpectrum();
        });

        // Initial draw
        drawSpectrum();
    </script>
</body>

</html>