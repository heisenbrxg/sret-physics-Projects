<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Emission Spectrum Simulation ‚Äî Water, Hydrogen, and Neon Behavior</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            margin: 0;
            background: radial-gradient(circle at center, #020817, #000010);
            font-family: 'Segoe UI', sans-serif;
            color: white;
            text-align: center;
            overflow: hidden;
        }

        h1 {
            margin-top: 15px;
            font-size: 2em;
            color: #bde0ff;
            text-shadow: 0 0 15px #409cff;
        }

        #controls {
            margin-top: 10px;
            font-size: 1.2em;
        }

        #spectrum {
            width: 90%;
            height: 60px;
            margin: 30px auto 10px;
            border: 2px solid #ccc;
            border-radius: 12px;
            background: linear-gradient(to right, violet, indigo, blue, cyan, green, yellow, orange, red);
            position: relative;
            box-shadow: 0 0 25px rgba(255, 255, 255, 0.3);
        }

        #marker {
            position: absolute;
            top: -10px;
            width: 6px;
            height: 80px;
            background: white;
            border-radius: 3px;
            box-shadow: 0 0 15px white;
            transition: left 0.3s ease;
        }

        #wavelengthDisplay {
            margin-top: 15px;
            font-size: 1.3em;
            color: #ffef9f;
            text-shadow: 0 0 10px #ffaa00;
        }

        button {
            background: linear-gradient(90deg, #06b6d4, #3b82f6);
            color: #fff;
            border: none;
            padding: 12px 25px;
            font-size: 1.1em;
            border-radius: 10px;
            cursor: pointer;
            box-shadow: 0 0 15px #06b6d4;
            transition: 0.3s;
            margin: 5px;
        }

        button:hover {
            transform: scale(1.07);
            box-shadow: 0 0 25px #3b82f6;
        }

        input,
        select {
            width: 160px;
            padding: 8px;
            border-radius: 6px;
            border: none;
            text-align: center;
            font-size: 1.1em;
            margin: 5px;
        }

        label {
            color: #bfe3ff;
            font-size: 1.1em;
        }

        #atomCanvas {
            display: block;
            margin: 30px auto;
            background: transparent;
            width: 1000px;
            height: 500px;
            border-radius: 12px;
        }

        #wavelengthLabels {
            display: flex;
            justify-content: space-between;
            width: 90%;
            margin: auto;
            font-size: 0.9em;
            color: #bfe3ff;
        }
    </style>
</head>

<body>
    <h1>üíß Emission Spectrum Simulation ‚Äî Water, Hydrogen & Neon üí°</h1>
    <p>Each source emits only its characteristic wavelength. Others are blocked.</p>

    <div id="controls">
        <label for="source">Select Source: </label>
        <select id="source">
            <option value="sun">‚òÄÔ∏è Sunlight</option>
            <option value="water">üíß Water Vapor</option>
            <option value="hydrogen">üî• Hydrogen Lamp</option>
            <option value="neon">üß™ Neon Lamp</option>
        </select>
        <br>
        <label for="wavelength">Wavelength (nm): </label>
        <input type="number" id="wavelength" value="480" min="380" max="750" step="1">
        <br>
        <button id="emitBtn">Emit Light</button>
        <button id="autoBtn">Start Continuous Mode üåà</button>
        <button id="stopBtn">Stop</button>
    </div>

    <div id="wavelengthDisplay"></div>
    <canvas id="atomCanvas" width="1000" height="500"></canvas>

    <div id="spectrum">
        <div id="marker"></div>
    </div>

    <div id="wavelengthLabels">
        <span>380nm (V)</span>
        <span>450nm (B)</span>
        <span>495nm (G)</span>
        <span>570nm (Y)</span>
        <span>600nm (O)</span>
        <span>750nm (R)</span>
    </div>

    <script>
        const canvas = document.getElementById('atomCanvas');
        const ctx = canvas.getContext('2d');
        const centerX = 400;
        const centerY = 250;
        const nucleusRadius = 25;

        let electron = { angle: 0, orbit: 100, color: "#00b4ff" };
        let emissionFlash = false;
        let lightColor = "white";
        let wavelength = 500;
        let autoMode = false;
        let autoInterval;
        let beamPulse = 0;

        let sourceType = "sun";
        const sources = {
            sun: { color: "#ffd700", label: "‚òÄÔ∏è Sunlight", glow: "#ffea00" },
            water: { color: "#60a5fa", label: "üíß Water Vapor", glow: "#60a5fa" },
            hydrogen: { color: "#87ceeb", label: "üî• Hydrogen Lamp", glow: "#87ceeb" },
            neon: { color: "#ff6600", label: "üß™ Neon Lamp", glow: "#ff6600" }
        };

        // Convert wavelength ‚Üí RGB
        function wavelengthToRGB(wl) {
            let R = 0, G = 0, B = 0;
            if (wl >= 380 && wl < 440) { R = -(wl - 440) / (440 - 380); G = 0; B = 1; }
            else if (wl >= 440 && wl < 490) { R = 0; G = (wl - 440) / (490 - 440); B = 1; }
            else if (wl >= 490 && wl < 510) { R = 0; G = 1; B = -(wl - 510) / (510 - 490); }
            else if (wl >= 510 && wl < 580) { R = (wl - 510) / (580 - 510); G = 1; B = 0; }
            else if (wl >= 580 && wl < 645) { R = 1; G = -(wl - 645) / (645 - 580); B = 0; }
            else if (wl >= 645 && wl <= 750) { R = 1; G = 0; B = 0; }
            let factor = 1;
            if (wl < 420) factor = 0.3 + 0.7 * (wl - 380) / (420 - 380);
            if (wl > 700) factor = 0.3 + 0.7 * (750 - wl) / (750 - 700);
            R = Math.round(255 * R * factor);
            G = Math.round(255 * G * factor);
            B = Math.round(255 * B * factor);
            return `rgb(${R},${G},${B})`;
        }

        function colorName(wl) {
            if (wl < 450) return "Violet/Blue";
            if (wl < 495) return "Cyan";
            if (wl < 570) return "Green";
            if (wl < 590) return "Yellow";
            if (wl < 620) return "Orange";
            return "Red";
        }

        function drawSetup() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            const pulseIntensity = 0.5 + 0.5 * Math.sin(beamPulse);
            beamPulse += 0.05;
            const src = sources[sourceType];

            // Source
            const sunX = 100, sunY = 250;
            const gradient = ctx.createRadialGradient(sunX, sunY, 20, sunX, sunY, 70);
            gradient.addColorStop(0, "#fff");
            gradient.addColorStop(1, src.color);
            ctx.beginPath();
            ctx.arc(sunX, sunY, 60, 0, 2 * Math.PI);
            ctx.fillStyle = gradient;
            ctx.shadowBlur = 40;
            ctx.shadowColor = src.glow;
            ctx.fill();
            ctx.shadowBlur = 0;

            // Beam
            ctx.beginPath();
            ctx.moveTo(sunX + 60, sunY);
            ctx.lineTo(centerX - 100, centerY);
            ctx.strokeStyle = `rgba(255,255,150,${0.3 + 0.3 * pulseIntensity})`;
            ctx.lineWidth = 20;
            ctx.shadowBlur = 20 * pulseIntensity;
            ctx.shadowColor = src.glow;
            ctx.stroke();
            ctx.shadowBlur = 0;

            // Filter
            ctx.beginPath();
            ctx.rect(centerX - 80, centerY - 100, 40, 200);
            ctx.fillStyle = "rgba(100,200,255,0.2)";
            ctx.strokeStyle = "#60a5fa";
            ctx.lineWidth = 3;
            ctx.fill();
            ctx.stroke();

            // Atom
            ctx.beginPath();
            ctx.arc(centerX, centerY, nucleusRadius, 0, 2 * Math.PI);
            ctx.fillStyle = "#ff375f";
            ctx.shadowBlur = 15;
            ctx.shadowColor = "#ff375f";
            ctx.fill();
            ctx.shadowBlur = 0;

            // Orbits
            ctx.strokeStyle = "#4ade80";
            ctx.lineWidth = 2;
            for (let i = 1; i <= 3; i++) {
                ctx.beginPath();
                ctx.arc(centerX, centerY, i * 50, 0, 2 * Math.PI);
                ctx.stroke();
            }

            // Electron
            const x = centerX + electron.orbit * Math.cos(electron.angle);
            const y = centerY + electron.orbit * Math.sin(electron.angle);
            ctx.beginPath();
            ctx.arc(x, y, 10, 0, 2 * Math.PI);
            ctx.fillStyle = electron.color;
            ctx.fill();

            // Detector
            const detX = centerX + 350;
            ctx.beginPath();
            ctx.rect(detX, centerY - 60, 40, 120);
            ctx.fillStyle = "rgba(255,255,255,0.1)";
            ctx.strokeStyle = "#fef08a";
            ctx.lineWidth = 3;
            ctx.fill();
            ctx.stroke();
            ctx.font = "20px Segoe UI";
            ctx.fillStyle = "#fff";
            ctx.fillText("üì° Detector", detX - 20, centerY + 100);

            // Emission flash
            if (emissionFlash) {
                const flashGradient = ctx.createRadialGradient(detX, centerY, 10, detX, centerY, 120);
                flashGradient.addColorStop(0, lightColor);
                flashGradient.addColorStop(1, "transparent");
                ctx.fillStyle = flashGradient;
                ctx.beginPath();
                ctx.arc(detX, centerY, 100, 0, 2 * Math.PI);
                ctx.fill();
            }

            ctx.font = "20px Segoe UI";
            ctx.fillStyle = "#ffffff";
            ctx.fillText(src.label, 50, 380);
            ctx.fillText("üî∑ Filter", centerX - 85, centerY + 145);
            ctx.fillText("‚öõ Atom", centerX - 20, centerY - 130);
        }

        function animate() {
            electron.angle += 0.02;
            drawSetup();
            requestAnimationFrame(animate);
        }
        animate();

        // ---- Physics Logic ----
        function emitLight() {
            const input = document.getElementById("wavelength");
            wavelength = parseFloat(input.value);
            if (isNaN(wavelength) || wavelength < 380 || wavelength > 750) {
                alert("Please enter wavelength between 380‚Äì750 nm");
                return;
            }

            // Emission rules
            if (sourceType === "water" && (wavelength < 470 || wavelength > 490)) {
                blockEmission("Water Vapor emits only ~480 nm (blue light).");
                return;
            }
            if (sourceType === "hydrogen" && (wavelength < 480 || wavelength > 490)) {
                blockEmission("Hydrogen emits only ~486 nm (light blue).");
                return;
            }
            if (sourceType === "neon" && (wavelength < 590 || wavelength > 610)) {
                blockEmission("Neon emits only ~600 nm (orange light).");
                return;
            }

            lightColor = wavelengthToRGB(wavelength);
            document.getElementById("wavelengthDisplay").innerHTML =
                `‚úÖ Wavelength: <b>${wavelength} nm</b> ‚Üí <span style="color:${lightColor}; font-weight:bold;">${colorName(wavelength)}</span>`;
            moveMarker(wavelength);

            // Electron excitation
            let step = 0;
            const absorb = setInterval(() => {
                electron.orbit += 2;
                step++;
                if (step > 40) {
                    clearInterval(absorb);
                    setTimeout(() => emitPhoton(), 700);
                }
            }, 20);
        }

        function blockEmission(msg) {
            document.getElementById("wavelengthDisplay").innerHTML = `<b style='color:red;'>‚ùå Blocked:</b> ${msg}`;
            moveMarker(wavelength);
        }

        function emitPhoton() {
            let step = 0;
            const emit = setInterval(() => {
                electron.orbit -= 2;
                step++;
                if (step > 40) {
                    clearInterval(emit);
                    emissionFlash = true;
                    flashSpectrum(lightColor);
                    setTimeout(() => emissionFlash = false, 600);
                }
            }, 20);
        }

        function flashSpectrum(color) {
            const spectrum = document.getElementById("spectrum");
            spectrum.style.boxShadow = `0 0 80px 20px ${color}`;
            setTimeout(() => spectrum.style.boxShadow = "0 0 25px rgba(255,255,255,0.3)", 800);
        }

        function moveMarker(wl) {
            const marker = document.getElementById("marker");
            const spectrumWidth = document.getElementById("spectrum").offsetWidth;
            const position = ((wl - 380) / (750 - 380)) * spectrumWidth;
            marker.style.left = `${position - 3}px`;
        }

        function startContinuousMode() {
            if (autoMode) return;
            autoMode = true;
            let wl = 380;
            autoInterval = setInterval(() => {
                if (wl > 750) wl = 380;
                document.getElementById("wavelength").value = wl.toFixed(0);
                emitLight();
                wl += 5;
            }, 900);
        }

        function stopContinuousMode() {
            autoMode = false;
            clearInterval(autoInterval);
        }

        document.getElementById("emitBtn").addEventListener("click", emitLight);
        document.getElementById("autoBtn").addEventListener("click", startContinuousMode);
        document.getElementById("stopBtn").addEventListener("click", stopContinuousMode);
        document.getElementById("source").addEventListener("change", e => {
            sourceType = e.target.value;
        });
    </script>
</body>

</html>